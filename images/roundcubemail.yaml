---
contents:
  packages:
    - tzdata
    - ca-certificates-bundle
    - lighttpd
    - roundcubemail@local
    - roundcubemail-plugin-carddav@local

entrypoint:
  command: /usr/sbin/lighttpd -f lighttpd.conf -D

work-dir: /usr/share/webapps/roundcubemail

accounts:
  run-as: 65532
  users:
    - uid: 65532
      username: roundcubemail
  groups:
    - gid: 65532
      groupname: roundcubemail

environment:
  PHP_FCGI_CHILDREN: 4
  PHP_FCGI_MAX_REQUESTS: 1000

paths:
  - path: /etc/roundcubemail
    type: directory
    uid: 65532
    gid: 65532
    permissions: 0o750

  - path: /var/log/roundcubemail
    type: directory
    uid: 65532
    gid: 65532
    permissions: 0o755

  - path: /var/lib/roundcubemail
    type: directory
    uid: 65532
    gid: 65532
    permissions: 0o755

  - path: /var/lib/roundcubemail/temp
    type: directory
    uid: 65532
    gid: 65532
    permissions: 0o755

volumes:
  - /var/log/roundcubemail
  - /var/lib/roundcubemail

annotations:
  org.opencontainers.image.title: roundcubemail
  dev.chainguard.package.main: roundcubemail
